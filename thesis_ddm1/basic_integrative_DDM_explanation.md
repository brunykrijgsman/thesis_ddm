# Integrated Model (7 parameters)

$$
r_i, x_i \sim DDM(\alpha, \tau, \delta_i, \beta) \\
z_i \sim N(\gamma \delta_i, \sigma^2) \\
\delta_i \sim \mathcal{N}(\mu_{\delta}, \eta^2_{\delta})
$$

This model integrates a standard DDM with a hierarchical latent process where the drift rate itself is a random quantity, and a latent variable is a noisy reflection of that drift rate.

---

### 1. The Observed Data

- **$r_i$**: the observed response time (RT) on trial $i$.
- **$x_i$**: the observed choice/response on trial $i$ (often a binary indicator of which decision boundary was reached).

The trial-level data $\{r_i, x_i\}$ are generated by a DDM defined by the parameters $\alpha$, $\tau$, $\delta_i$, and $\beta$.

---

### 2. The Drift Diffusion Model (DDM)

The core of the model is the standard DDM:

- **Boundary separation $\alpha$**:  
  Defines how much evidence is required to make a decision.

- **Non-decision time $\tau$**:  
  Accounts for processes like sensory encoding and motor execution that are not part of the decision process.

- **Drift rate $\delta_i$**:  
  Governs the evidence accumulation speed. Unlike fixed effects in some models, here the drift rate varies across trials, capturing trial-to-trial fluctuations in decision dynamics.

- **Starting point / bias $\beta$**:  
  Represents an a priori bias in the starting position of the accumulation process. If $\beta = 0.5$, the process is unbiased.

In this formulation, the DDM uses the trial-specific drift rate $\delta_i$, which itself is drawn from a normal distribution:

$$
\delta_i \sim \mathcal{N}(\mu_{\delta}, \eta^2_{\delta}).
$$

---

### 3. The Latent Variable $z_i$

- **$z_i$** is an unobserved (latent) variable associated with each trial $i$.
- It is assumed to follow a normal distribution whose mean is determined by the drift rate:
  $$
  z_i \sim N(\gamma\, \delta_i, \sigma^2).
  $$

This latent variable can be interpreted as a noisy, scaled indication of the underlying drift rate that drives the decision process.

---

### 4. Linking the Drift Rate to the Latent Variable

In contrast to models where the latent variable directly determines the drift rate (e.g., $\delta_i = \lambda z_i + b$), here the drift rate $\delta_i$ is the primary random effect:

1. **Drift rate generation:**  
   For each trial, $\delta_i$ is sampled from a normal distribution with mean $\mu_{\delta}$ and variance $\eta^2_{\delta}$.

2. **Latent measurement:**  
   Subsequently, the latent variable $z_i$ is generated from a normal distribution with mean equal to $\gamma$ times the drift rate, $ \gamma \delta_i $, and variance $\sigma^2$.

This structure implies that the latent factor is a noisy observation of the true drift rate, with $\gamma$ scaling the drift rate's contribution and $\sigma^2$ capturing the extra variability.

---

### 5. Putting It All Together

The data-generation process can be summarized as follows:

1. **Generate the drift rate:**  
   For trial $i$, sample:

   $$
   \delta_i \sim \mathcal{N}(\mu_{\delta}, \eta^2_{\delta}).
   $$

2. **Generate the latent variable:**  
   Conditional on $\delta_i$, sample:

   $$
   z_i \sim N(\gamma\, \delta_i, \sigma^2).
   $$

3. **Generate RT and choice data:**  
   Using the DDM with parameters $\alpha$, $\tau$, $\beta$, and the trial-specific $\delta_i$, generate:
   $$
   r_i,\, x_i \sim DDM(\alpha, \tau, \delta_i, \beta).
   $$

Thus, the model has **7 parameters** in total:

1. **$\alpha$**: Boundary separation.
2. **$\tau$**: Non-decision time.
3. **$\beta$**: Starting point bias.
4. **$\mu_{\delta}$**: Mean drift rate.
5. **$\eta_{\delta}$**: Standard deviation of the drift rate.
6. **$\gamma$**: Scaling parameter linking $\delta_i$ to $z_i$.
7. **$\sigma$**: Standard deviation of the latent variable $z_i$.

---

## Intuitive Interpretation

1. **Dual-level Variability:**

   - The drift rate $\delta_i$ varies from trial to trial, reflecting fluctuations in the speed or quality of evidence accumulation.
   - The latent variable $z_i$ is not directly used to compute $\delta_i$; rather, it provides a noisy, scaled snapshot of the drift rate.

2. **Measurement Noise:**

   - The latent variable $z_i$ is generated with additional variability ($\sigma^2$), suggesting that it captures the drift rate $\delta_i$ imperfectly. This could represent measurement error or unobserved influences that alter how the drift rate is expressed.

3. **Integrated Modeling:**

   - By combining the DDM core with a latent measurement component, the model accounts for both the observed decision behavior and an underlying, indirectly measured process. This can provide a richer interpretation of the trial-to-trial variability.
   - A higher drift rate $\delta_i$ will tend to produce a higher expected value for $z_i$ (scaled by $\gamma$), which might be linked to cognitive factors such as attention, motivation, or task difficulty.

4. **Flexibility:**
   - This structure allows researchers to disentangle the variability inherent in the decision process (via $\delta_i$) from the noise present in its latent representation (via $z_i$). It offers an alternative perspective compared to models where a latent factor directly determines the drift rate.

In summary, the integrated model enriches the standard DDM by introducing a hierarchical latent variable that provides a noisy measurement of the underlying drift rate, thereby capturing additional complexity in behavioral data.
